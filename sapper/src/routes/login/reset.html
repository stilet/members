<script>
  import InputField from 'src/components/InputField.html'

  import { notify } from 'src/stores/notifications'
  // import { goto } from '../../../__sapper__/client.js'

  export let resetEmail;
  export let resetPending = false;

  // [svelte-upgrade suggestion]
  // review these functions and remove unnecessary 'export' keywords
  export async function resetPassword(email) {
    resetPending = true
    await fetch('/auth/password-forgot', {
      method: 'POST',
      headers: {
        'content-type': 'application/json'
      },
      body: JSON.stringify({
        email
      })
    })
    resetPending = false
    notify('info', 'Reset received')
    // goto('/login/reset-received')
  }
</script>

<form on:submit|stopPropagation|preventDefault='{() => resetPassword(resetEmail)}'>
  <InputField horizontal
    type='email'
    disabled={resetPending}
    label='Email'
    value={resetEmail || ''}
    on:change="{event => resetEmail = event}"
  />

  <div class="buttons is-right">
    <button type='submit' class="button is-primary" class:is-loading='{resetPending}'>
      Send reset email
    </button>
  </div>
</form>