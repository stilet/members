<p>Add member</p>

<MemberEdit
  on:submit=createMember(event)
  disabled={saving}
/>

<pre>
  {JSON.stringify(CREATE_MEMBER, null, 2)}
</pre>

<script>
  import gql from 'graphql-tag'

  const CREATE_MEMBER = gql`
    mutation {
      insert_member(objects:{
        name: "new-user",
        fullname: "This new user"
      }) {
        returning {
          name
        }
      }
    }
  `

  export default {
    components: {
      MemberEdit: 'src/components/MemberEdit.html'
    },
    data () {
      return {
        CREATE_MEMBER
      }
    },
    methods: {
      async createMember(data) {
        try {
          this.set({ saving: true })
          await this.store.addMember(data)
          this.set({ saving: false })

          console.log("Creating", data)
          
        } catch (e) {
          console.error("Error trying to create member", e)
        }
      }
    }
  }
</script>