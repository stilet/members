<nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="/">
      <img src="/wolbodo.png" alt='logo' width="112" height="28">
    </a>

    <a role="button" href='open-menu'
    	class="navbar-burger burger"
    	class:is-active="navbarOpen"
    	on:click|stopPropagation|preventDefault="set({navbarOpen: !navbarOpen})"
    	aria-label="menu"
    	aria-expanded="false"
    >
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbar-content" class="navbar-menu" class:is-active="navbarOpen">
    <div class="navbar-start">

      {#if $hasRoles('admin')}
        <a class="navbar-item" href='/mails'>
          Mails
        </a>
      {/if}

			<!-- 
      <a class="navbar-item" href='/members'>
        Home
      </a>

      <a class="navbar-item">
        Documentation
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More
        </a>

        <div class="navbar-dropdown">
          <a class="navbar-item">
            About
          </a>
          <a class="navbar-item">
            Jobs
          </a>
          <a class="navbar-item">
            Contact
          </a>
          <hr class="navbar-divider">
          <a class="navbar-item">
            Report an issue
          </a>
        </div>
      </div>
      -->
    </div>

    <div class="navbar-end">
      <div class="navbar-item">
        <div class="buttons">
          {#if $loggedIn}
            {#if $user}
            <a href='/members/{$user.name}' class="button">
              {$user.name}
            </a>
            {/if}
            <button class="button is-primary" class:is-loading='loading' disabled="{loading}" on:click='logout()'>
              Log out
            </button>
          {:else}
            <a class="button is-primary" href='/'>
              Log in
            </a>
          {/if}
        </div>
      </div>
    </div>
  </div>
</nav>

<script>
	export default {
		data () {
			return {
				navbarOpen: false
			}
		},
    methods: {
      async logout () {
        try {
          this.set({ loading : true })
          await this.store.logout()
          this.set({ loading : false })
        } catch (e) {
          this.set({ loading : false })
          console.error("Error:", e)
        }
      }
    }
	}
</script>