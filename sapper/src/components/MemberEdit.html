<script>
  import { createEventDispatcher } from 'svelte';

  const dispatch = createEventDispatcher();

  import {
  TextField,
  DateField,
  EmailField,
  InputGroup,
  // InputControl,
} from 'svelte-bulma-forms/module'

import { goto } from '../../__sapper__/client.js'

export let memberEdit = {};
  export let member;
  export let loading;

  export let _member;
  $: _member = {
      ...member,
      ...memberEdit
    };

  // [svelte-upgrade suggestion]
  // review these functions and remove unnecessary 'export' keywords
  export async function submitForm(ev) {
  ev.preventDefault()
  ev.stopPropagation()
  loading = true

  console.log("Trying submit")
  const res = await dispatch('submit', memberEdit)
  console.log("Done submitting")

  // const res = await this.store.addMember(memberEdit)
  loading = false

  // console.log("Added member:", memberEdit, res)

}

  export function fieldChange(name, value) {
  memberEdit = {
      ...memberEdit,
      [name]: value
    }
}
</script>

<form on:submit|preventDefault|stopPropagation="{() => dispatch('submit', memberEdit)}" disabled='{loading}' >

  <fieldset>
    <legend>Name & Contact</legend>

    <TextField horizontal
      label='Alias'
      placeholder='Wikkert'
      required
      value={_member.name || ''}
      disabled={loading}
      on:change="{event => fieldChange('name', event)}"
    />


    <InputGroup label='Name' horizontal>
      <TextField horizontal
        placeholder='Wikkert'
        value={_member.firstname || ''}
        disabled={loading}
        on:change="{event => fieldChange('firstname', event)}"
      />
      <TextField horizontal
        placeholder='Olbodo'
        value={_member.lastname || ''}
        disabled={loading}
        on:change="{event => fieldChange('lastname', event)}"
      />
    </InputGroup>

    <EmailField horizontal
      label='Email'
      placeholder='wikkert@wolbodo.nl'
      value={_member.email || ''}
      disabled={loading}
      on:change="{event => fieldChange('email', event)}"
    />
    <TextField horizontal
      label='Phone'
      placeholder='+31 000 0000 000'
      value={_member.phone || ''}
      disabled={loading}
      on:change="{event => fieldChange('phone', event)}"
    />
  </fieldset>

  <fieldset>
    <legend>Address info</legend>

    <TextField horizontal
      label='Address'
      placeholder='Verwersdijk 102'
      value={_member.address || ''}
      disabled={loading}
      on:change="{event => fieldChange('address', event)}"
    />

    <InputGroup label='' horizontal>
      <TextField horizontal
        label='Zipcode'
        placeholder='2611NK'
        value={_member.zipcode || ''}
        disabled={loading}
        on:change="{event => fieldChange('zipcode', event)}"
      />
      <TextField horizontal
        label='City'
        placeholder='Delft'
        value={_member.city || ''}
        disabled={loading}
        on:change="{event => fieldChange('city', event)}"
      />
    </InputGroup>

    <TextField horizontal
      label='Country'
      placeholder='Nederland'
      value={_member.country || ''}
      disabled={loading}
      on:change="{event => fieldChange('country', event)}"
    />
  </fieldset>

  <div class="buttons is-right">
    <button type=submit class="button is-link" class:is-loading='{loading}' disabled="{loading}">Submit</button>
  </div>
  <pre>
    {JSON.stringify(memberEdit, null, 2)}
  </pre>
</form>

<style>
  fieldset {
    padding: 1em;
    padding-top: 0;
    margin: 1em 0;
    border: 2px solid #0000001a;

  }
</style>